
rule SuspiciousStrings {
    meta:
        description = "Detects suspicious strings in malware"
    strings:
        $s1 = "cmd.exe" nocase
        $s2 = "powershell" nocase
        $s3 = "rundll32" nocase
        $s4 = "regsvr32" nocase
        $s5 = "wscript" nocase
        $s6 = "cscript" nocase
        $s7 = "malware" nocase
        $s8 = "trojan" nocase
        $s9 = "backdoor" nocase
    condition:
        any of ($s*)
}

rule WindowsPEExecutable {
    meta:
        description = "Detects Windows PE executables"
    strings:
        $mz = "MZ"
    condition:
        $mz at 0
}

rule SuspiciousNetworkActivity {
    meta:
        description = "Detects suspicious network patterns"
    strings:
        $ip1 = /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/ 
        $url = "http://" nocase
        $socket = "socket" nocase
    condition:
        2 of them
}
